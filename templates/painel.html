
<!DOCTYPE html>
<html>
<head>
  <title>Painel do Bot</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    h1 { color: #2c3e50; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f5f5f5; }
    .ativo { color: green; font-weight: bold; }
    .parado { color: red; font-weight: bold; }
    .btn { padding: 8px 14px; margin: 4px; font-weight: bold; cursor: pointer; border: none; border-radius: 6px; }
    .btn-start { background: #2ecc71; color: white; }
    .btn-stop { background: #e74c3c; color: white; }
    .btn-modo { background: #3498db; color: white; }
  </style>
</head>
<body>
  <h1>Painel de Operações</h1>
  <p>Status: <span class="{{ 'ativo' if ativo else 'parado' }}">{{ 'Ativo' if ativo else 'Parado' }}</span></p>
  <p>Modo: <strong>{{ modo }}</strong></p>
  <p>Moedas monitoradas: {{ moedas | join(', ') }}</p>
  <p>Saldo disponível: <strong>USDT {{ saldo }}</strong></p>
<h3>Modo atual: {{ modo }}</h3>
  <button class="btn btn-start" onclick="acionarBot('/bot/start')">Ativar Bot</button>
  <button class="btn btn-stop" onclick="acionarBot('/bot/stop')">Parar Bot</button>
  <br><br>
  <button class="btn btn-modo" onclick="definirModo('agressivo')">Modo Agressivo</button>
  <button class="btn btn-modo" onclick="definirModo('moderado')">Modo Moderado</button>
  <button class="btn btn-modo" onclick="definirModo('conservador')">Modo Conservador</button>

  <h2>Histórico de Operações</h2>
  <table>
    <tr>
      <th>Moeda</th>
      <th>Preço</th>
      <th>Data</th>
      <th>Ação</th>
    </tr>
    {% for op in operacoes %}
    <tr>
      <td>{{ op.symbol }}</td>
      <td>{{ op.preco }}</td>
      <td>{{ op.data }}</td>
      <td>{{ op.acao }}</td>
    </tr>
    {% endfor %}
  </table>

  <h2>Gráfico de Preços (simulado)</h2>
  <canvas id="grafico" height="100"></canvas>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    const ctx = document.getElementById('grafico').getContext('2d');
    const chart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: ['Dia 1', 'Dia 2', 'Dia 3', 'Dia 4', 'Dia 5'],
        datasets: [
          {
            label: 'BTCUSDT',
            data: [62000, 61500, 61800, 62200, 62400],
            borderWidth: 2,
            fill: false,
            borderColor: 'blue'
          },
          {
            label: 'ETHUSDT',
            data: [3200, 3150, 3175, 3220, 3250],
            borderWidth: 2,
            fill: false,
            borderColor: 'green'
          }
        ]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: false
          }
        }
      }
    });

    function acionarBot(endpoint) {
      fetch(endpoint, { method: 'POST' })
        .then(() => alert("Comando enviado com sucesso!"))
        .catch(() => alert("Erro ao enviar comando"));
    }

    function definirModo(modo) {
      fetch('/modo', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ perfil: modo })
      }).then(() => alert("Modo alterado para: " + modo))
        .catch(() => alert("Erro ao alterar modo"));
    }
  </script>
</body>
</html>
